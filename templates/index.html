<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='assets/favicon.ico') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Starting Nine</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        /* Remove Firefox :valid checkmark and green border */
        input[type="text"]:valid,
        input[type="text"]:invalid {
            box-shadow: none !important;
            border-color: #222 !important;
            background-image: none !important;
        }
        .submit-btn-pos {
            position: absolute;
            left: -60px;
            bottom: 10px;
            z-index: 20;
        }
    </style>
</head>
<body>
    <!-- Welcome Modal -->
    <div class="modal fade" id="welcomeModal" tabindex="-1" aria-labelledby="welcomeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="welcomeModalLabel">Think you can name the starting lineup of every MLB team?</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>
                        The <b>Starting Nine</b> game selects a <b>random MLB team</b> and asks you to name the people who played <b>the most games at each position for that team that season.</b> 
                        <br><br>
                        You need to provide both <b>first and last names</b> (last name only won’t work!) but we’ll do our best to give credit for misspellings. You don’t have to make a guess for every spot - you can leave something blank if you don’t know. Don’t know anybody? Just reload the page for a different team!
                        <br><br>
                        Right now, we’ve limited it to only teams since the year 2000 but we’ve got plans to expand in the future. The data for who played the most games at each position was provided by <a href="https://www.baseball-reference.com" target="_blank">Baseball Reference</a>. If you notice something that seems incorrect, email me at <a href="mailto:info@startingninegame.com">info@startingninegame.com</a> and I’ll look into it.
                        <br><br>
                        Thanks for playing!
                    </p>
    </style>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/game.js') }}"></script>
    <!-- Floating Help Button (moved to end of body for visibility) -->
    <button id="helpButton" type="button" style="position:fixed;bottom:110px;right:24px;z-index:1050;background:transparent;border:none;padding:0;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,0.15);border-radius:50%;width:56px;height:56px;display:flex;align-items:center;justify-content:center;">
        <img src="static/assets/Q.png" alt="Help" style="width:48px;height:48px;" />
    </button>
    <script>
        window.addEventListener('DOMContentLoaded', function() {
            // Only show modal if not already shown in this browser session
            // if (!localStorage.getItem('welcomeModalShown')) {
            //     var welcomeModal = new bootstrap.Modal(document.getElementById('welcomeModal'));
            //     welcomeModal.show();
            //     localStorage.setItem('welcomeModalShown', 'true');
            // }
            // Help button event
            var helpBtn = document.getElementById('helpButton');
            if (helpBtn) {
                helpBtn.addEventListener('click', function() {
                    var welcomeModal = new bootstrap.Modal(document.getElementById('welcomeModal'));
                    welcomeModal.show();
                });
            }
        });
    </script>

    <header class="text-center py-4 w-100" style="width:100vw; left:0; right:0; top:0; margin:0; border-radius:0;">
        <img src="static\assets\StartingNineBannerShort.png" alt="Starting Nine Banner" style="width: 100%; height: auto; margin-bottom: 10px;" />
        <div class="game-info">
            <h2 class="h3" style="color:white">{{ year }} {{ team }}</h2>
            <p class="lead" style="color:white">Guess the starting lineup for the {{ year }} {{ team }}!</p>
        </div>
    </header>
    <div class="container-fluid">

        <main>
            <!-- Baseball Diamond -->
            <div class="baseball-diamond-container">
                <div class="baseball-diamond">
                    <svg viewBox="0 0 400 400" class="diamond-svg">
                        <!-- Diamond outline -->
                        <polygon points="200,50 350,200 200,350 50,200" 
                                fill="#8FBC8F" stroke="#654321" stroke-width="3"/>
                        
                        <!-- Pitcher's mound -->
                        <circle cx="200" cy="200" r="15" fill="#8FBC8F" stroke="#654321" stroke-width="2"/>
                        
                        <!-- Bases -->
                        <rect x="195" y="345" width="10" height="10" fill="white" stroke="#000" stroke-width="1"/>
                        <rect x="345" y="195" width="10" height="10" fill="white" stroke="#000" stroke-width="1"/>
                        <rect x="195" y="45" width="10" height="10" fill="white" stroke="#000" stroke-width="1"/>
                        <rect x="45" y="195" width="10" height="10" fill="white" stroke-width="1"/>
                        
                        <!-- Home plate -->
                    <!-- Move submit button directly below catcher input field -->
                    <div class="d-flex justify-content-center mt-2">
                        <button type="submit" class="btn btn-primary" id="submitGuesses">Submit Guesses</button>
                    </div>
                    <div class="position-input catcher-pos">
                        <label for="C" class="position-label">Catcher</label>
                        <input type="text" id="C" name="C" class="form-control position-field" 
                               placeholder="Enter player name" maxlength="50" 
                               pattern="[A-Za-z '.]+|^$" title="Only letters, spaces, apostrophes, and periods allowed">
                    </div>
                    
                    <!-- First Base -->
                    <div class="position-input first-base-pos">
                        <label for="1B" class="position-label">First Base</label>
                        <input type="text" id="1B" name="1B" class="form-control position-field" 
                               placeholder="Enter player name" maxlength="50" 
                               pattern="[A-Za-z '.]+|^$" title="Only letters, spaces, apostrophes, and periods allowed">
                    </div>
                    
                    <!-- Second Base -->
                    <div class="position-input second-base-pos">
                        <label for="2B" class="position-label">Second Base</label>
                        <input type="text" id="2B" name="2B" class="form-control position-field" 
                               placeholder="Enter player name" maxlength="50" 
                               pattern="[A-Za-z '.]+|^$" title="Only letters, spaces, apostrophes, and periods allowed">
                    </div>
                    
                    <!-- Third Base -->
                    <div class="position-input third-base-pos">
                        <label for="3B" class="position-label">Third Base</label>
                        <input type="text" id="3B" name="3B" class="form-control position-field" 
                               placeholder="Enter player name" maxlength="50" 
                               pattern="[A-Za-z '.]+|^$" title="Only letters, spaces, apostrophes, and periods allowed">
                    </div>
                    
                    <!-- Shortstop -->
                    <div class="position-input shortstop-pos">
                        <label for="SS" class="position-label">Shortstop</label>
                        <input type="text" id="SS" name="SS" class="form-control position-field" 
                               placeholder="Enter player name" maxlength="50" 
                               pattern="[A-Za-z '.]+|^$" title="Only letters, spaces, apostrophes, and periods allowed">
                    </div>
                    
                    <!-- Left Field -->
                    <div class="position-input left-field-pos">
                        <label for="LF" class="position-label">Left Field</label>
                        <input type="text" id="LF" name="LF" class="form-control position-field" 
                               placeholder="Enter player name" maxlength="50" 
                               pattern="[A-Za-z '.]+|^$" title="Only letters, spaces, apostrophes, and periods allowed">
                    </div>
                    
                    <!-- Center Field -->
                    <div class="position-input center-field-pos">
                        <label for="CF" class="position-label">Center Field</label>
                        <input type="text" id="CF" name="CF" class="form-control position-field" 
                               placeholder="Enter player name" maxlength="50" 
                               pattern="[A-Za-z '.]+|^$" title="Only letters, spaces, apostrophes, and periods allowed">
                    </div>
                    
                    <!-- Right Field -->
                    <div class="position-input right-field-pos">
                        <label for="RF" class="position-label">Right Field</label>
                        <input type="text" id="RF" name="RF" class="form-control position-field" 
                               placeholder="Enter player name" maxlength="50" 
                               pattern="[A-Za-z '.]+|^$" title="Only letters, spaces, apostrophes, and periods allowed">
                    </div>
                    
                    <!-- Designated Hitter (if applicable) -->
                    {% if has_dh %}
                    <div class="position-input dh-pos">
                        <label for="DH" class="position-label">Designated Hitter</label>
                        <input type="text" id="DH" name="DH" class="form-control position-field" 
                               placeholder="Enter player name" maxlength="50" 
                               pattern="[A-Za-z '.]+|^$" title="Only letters, spaces, apostrophes, and periods allowed">
                    </div>
                    {% endif %}
                    <!-- ...existing code... -->
                </div>
            </div>
            
            <!-- New Game Button (remains in the same position as before) -->
            <div class="text-center mt-4">
                <button type="button" id="newGame" class="btn btn-secondary btn-lg ms-3" style="display: none;">
                    New Game
                </button>
            </div>
            
            <!-- Loading Spinner -->
            <div id="loadingSpinner" class="text-center mt-3" style="display: none;">
                <div class="spinner-border" aria-label="Loading game results">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>
            
            <!-- Results Section -->
            <div id="resultsSection" class="mt-5" style="display: none;">
                <h3 class="text-center mb-4">Game Results</h3>
                
                <!-- Score Summary -->
                <div class="score-summary text-center mb-4">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">Correct Guesses</h5>
                                    <p class="card-text display-6" id="correctCount">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">Total Players</h5>
                                    <p class="card-text display-6" id="totalPlayers">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">Percentage</h5>
                                    <p class="card-text display-6" id="percentage">0%</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Detailed Results Table -->
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-dark">
                            <tr>
                                <th>Position</th>
                                <th>Your Guess</th>
                                <th>Correct Answer</th>
                                <th>Result</th>
                            </tr>
                        </thead>
                        <tbody id="resultsTableBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Error Modal -->
    <div class="modal fade" id="errorModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Error</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="errorMessage">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/game.js') }}"></script>
</body>
</html>
